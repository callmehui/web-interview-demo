### Javascript 面试题 - http

#### 1. 常见的状态码

- 200 成功
- 301 永久重定向（配合 Location，浏览器自动处理: 在响应头里面有一个 Location 字段，值为要跳转的地址）
- 302 临时重定向（配合 Location，浏览器自动处理: 在响应头里面有一个 Location 字段，值为要跳转的地址）
- 304 资源未被修改（协商缓存）
- 403 没有权限访问
- 404 资源找不到
- 500 服务器错误
- 504 网关超时

#### 2. http methods

##### 传统的 methods

get: 获取服务器数据
post: 更新数据

##### 现代的 methods

get: 获取服务器数据
post: 新建数据
patch/put: 更新数据
delete: 删除数据

#### 3. restful api

#### 4.常见的 headers

##### request/response headers（常见请求/响应头）

1. Accept: 浏览器可接受的数据格式；
2. Accept-Encoding: 浏览器可接收的压缩算法，如：gzip 压缩算法；
3. Accept-Language: 浏览器可接收的语言，如：zh-CN(中文)；
4. Connection: keep-alive 一次 TCP 连接重复使用；
5. cookie: 每次请求同一个域名都会自动带上 cookie；
6. Host: 请求的地址的域名；
7. User-Agent: 浏览器信息；
8. Content-type: 向服务器发送的数据的格式，如：application/json；
9. Content-length: 返回数据的大小，多少字节；
10. Content-Encoding: 返回数据的压缩算法，如 gzip 压缩算法；
11. Set-cookie: 服务端修改 cookie 的方式；

headers 可以自定义，前端自定义请求头，后端自定义响应头

##### 缓存相关的 headers:

Cache-control

#### 5. http 缓存

##### 1. 缓存的介绍

1. 什么是缓存？

2. 为什么需要缓存？

3. 减少网络请求的数量；

4. 哪些资源可以被缓存？

一些静态资源（js css img）？

##### 2. Cache-Control(强制缓存)

1. Cache-Control 被设置在 response header(响应头)中，
2. 用于控制强制缓存的逻辑，
3. 例如：Cache-Control: max-age=3600(单位是秒)

逻辑描述：

1. 从客户端向服务器请求资源，服务器返回资源和强制缓存（Cache-Control）的策略；
2. 浏览器根据资源的强制缓存策略来缓存资源；
3. 再次请求资源时，从缓存获取数据而不是从服务器获取资源（前提是缓存策略设置的时间没过期）；
4. 如果缓存失效，就会重新从服务器返回资源和强制缓存(Cache-Control)策略；

Cache-Control 可能设置的值

1. max-age: 设置缓存过期时间；
2. no-cache: 不设置客户端缓存；
3. no-store: 不设置客户端和服务端缓存，每次重新返回新资源；
4. private: 只允许最终用户缓存；
5. public: 也允许中间代理缓存；

##### 3. expires（用于设置缓存过期时间，已被 Cache-Control 代替）

##### 4. 协商缓存

1. 协商缓存属于服务端缓存策略；
2. 客户端请求的服务端的资源，服务端会判断客户端的资源是否和服务端的资源一致，如果一致就会返回 304，否则从服务端返回最新的资源给客户端；

Last-Modified: 精确到秒级别，在设置的时间内再次请求资源会命中缓存；
ETag: 为每个资源设置一个标识符（唯一的字符串），标识符没变化就会命中缓存；

ETag 和 Last-Modified 同时存在时，优先以 ETag 为准；对于文件而言，如果文件本身没有变化，使用 ETag 就会一直命中缓存，而 Last-Modified 会在设置的时间过期后重新返回新数据；

##### 5. 综述

强制缓存是客户端的缓存策略，协商缓存是服务端的缓存策略。缓存的资源存放在客户端，两种缓存策略的目的是为了判断是否使用客户端的缓存资源来加快资源的加载而不是重新请求服务端的资源。
具体步骤是：

1. 如果请求的资源本地有缓存并且缓存没有过期（Cache-Control 的 max-age 设置资源过期时间），则直接读取客户端的缓存资源，这就是强缓存；
2. 如果当前时间已经超过了强制缓存设置的过期时间，就会向服务端发送请求，服务端会优先判断是否设置了 ETag 或者 LastModified（是否启用了协商缓存），如果没有设置则直接从服务端返回资源；
3. 如果服务端设置了 ETag 或者 LastModified（启用了协商缓存），则服务端会判断是否可以使用客户端的缓存资源（ETag 会对比客户端的资源和服务端是否一致，如果一致则判断资源没有被修改，会返回 304；Last-Modified 会判断资源是否过期，没有超过过期时间则判断资源没有被修改，返回 304），如果可以使用客户端的缓存就会返回 304 指示使用客户端的缓存，否则返回 200 并从服务端返回最新的资源给客户端。

##### 6. 三种刷新操作对缓存的影响

1. 正常操作，如：地址栏输入 url，页面跳转等；
2. 手动刷新，如：点击刷新按钮，F5 刷新(windows)，cmd + r(mac)；
3. 强制刷新，如：点击浏览器的强制刷新，ctrl + F5(windows)， cmd + shift + r(mac)；

三种操作对于缓存的影响：

正常操作：强制缓存有效，协商缓存有效；
手动刷新：强制缓存失效，协商缓存有效；
强制刷新：强制缓存失效，协商缓存失效；
