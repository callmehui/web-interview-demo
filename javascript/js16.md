### Javascript 面试题 - 性能优化

#### 性能优化原则

- 多使用内存、缓存或者其他方法
- 减少 CPU 计算量，减少网络加载耗时
- （适用于所有编程的性能优化 - 空间换时间）

> 从何入手

- 让加载更快

1. 压缩资源体积： 压缩代码；
2. 减少代码访问次数：合并代码(合并 js 代码、css 代码、雪碧图)，ssr 服务端渲染，缓存(更多地命中缓存)；
3. 使用更快的网络：cdn;

- 让渲染更快

1. css 放在 head 内，js 文件放在 body 下；
2. 尽快地开始执行 js，用 DOMContentLoaded 触发；
3. 懒加载（图片懒加载，上滑动加载更多）；

#### 性能优化示例

1. 资源合并

把文件 a.js、b.js、c.js 合并成一个文件 abc.js，文件的大小可能不变，但是只发送一次请求，开销更小。

2. 缓存

a. 静态资源加 hash 后缀，根据文件内容计算 hash 值；
b. 文件内容不变，则 hash 不变，则 url 不变；
c. url 和文件不变，则自动触发 http 缓存机制（认为文件没有变化），返回 304；

3. cdn

利用区域内对资源进行加速；

4. ssr（服务端渲染）

a. 服务端渲染：将网页和数据一起加载，一起渲染；
b. 非 SSR（前端端分离）：先加载网页，再加载数据，再渲染数据；

5. 懒加载

图片懒加载：原理就是先显示一个资源大小很小的图片代替，当图片需要渲染的时候再把图片渲染出来。

6. 多个 DOM 操作一起插入到 DOM 结构

每次 DOM 插入操作都会触发页面回流，而把多次操作集合到一起只会触发一次页面回流。

回流：DOM 结点的移动和增删会触发回流，开销相对于重绘更大，因为重绘一定会触发重绘。
重绘：改变元素的样式，如颜色改变、位置改变等 css 操作会触发重绘，重绘不会引起 DOM 结点的移动和增删。
